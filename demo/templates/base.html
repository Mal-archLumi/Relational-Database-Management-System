<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}MALDB Professional Interface{% endblock %}</title>
    <link rel="stylesheet" href="/static/style.css">
    <script src="/static/script.js" defer></script>
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header class="header">
            <div class="logo">
                <div class="logo-icon">M</div>
                <span>MALDB</span>
            </div>
            
            <div class="header-actions">
                <div class="database-indicator" id="currentDbIndicator">
                    <span class="db-icon">ğŸ—ƒï¸</span>
                    <span id="currentDbName">default</span>
                    <span style="font-size: 12px; color: var(--text-secondary); margin-left: 8px;">
                        â€¢ <span id="tableCount">0 tables</span>
                    </span>
                </div>
                <div class="status-indicator status-online"></div>
                <span style="font-size: 13px; color: var(--text-secondary);">Connected</span>
                <div style="width: 1px; height: 20px; background: var(--border-dark); margin: 0 12px;"></div>
                <button class="toolbar-btn" onclick="window.open('/api/docs', '_blank')">
                    API Docs
                </button>
            </div>
        </header>
        
        <!-- Sidebar -->
        <nav class="sidebar">
            <div class="nav-section">
                <div class="nav-title">Navigation</div>
                <a href="#" class="nav-item active" data-page="query">
                    <span>ğŸ“ Query Editor</span>
                </a>
                <a href="#" class="nav-item" data-page="tables">
                    <span>ğŸ“Š Tables</span>
                </a>
                <a href="#" class="nav-item" data-page="history">
                    <span>ğŸ“œ History</span>
                </a>
                <a href="#" class="nav-item" data-page="monitor">
                    <span>ğŸ“ˆ Monitor</span>
                </a>
            </div>
            
            <div class="nav-section">
                <div class="nav-title">Databases</div>
                <div id="databaseList">
                    <!-- Databases will be loaded here by JavaScript -->
                </div>
                <button class="nav-item" onclick="maldb.showCreateDatabaseModal()" style="background: transparent; border: none; color: var(--text-secondary); width: 100%; text-align: left; padding: 8px 12px; cursor: pointer; border-radius: 4px; transition: background 0.2s; margin-top: 8px;">
                    <span>â• Create New Database</span>
                </button>
            </div>
            
            <div class="nav-section">
                <div class="nav-title">Quick Actions</div>
                <a href="#" class="nav-item quick-action" data-sql="CREATE TABLE users (id INT PRIMARY KEY, username VARCHAR(50), email VARCHAR(100), password TEXT ENCRYPTED, age INT, is_active BOOLEAN)">
                    <span>ğŸ“„ Create Users Table</span>
                </a>
                <a href="#" class="nav-item quick-action" data-sql="INSERT INTO users VALUES (1, 'admin', 'admin@example.com', 'securepassword123', 25, true)">
                    <span>â• Insert Sample Data</span>
                </a>
                <a href="#" class="nav-item quick-action" data-sql="SELECT * FROM users">
                    <span>ğŸ‘¥ Query All Users</span>
                </a>
            </div>
            
            <div class="nav-section" style="margin-top: auto;">
                <div class="nav-title">System</div>
                <div style="padding: var(--spacing-sm) var(--spacing-md); font-size: 12px; color: var(--text-tertiary);">
                    <div>MALDB v1.0.0</div>
                    <div>Pesapal Challenge 2026</div>
                </div>
            </div>
        </nav>
        
        <!-- Main Content -->
        <main class="main-content">
            {% block content %}{% endblock %}
        </main>
    </div>
    
    <!-- Modal for creating new database -->
    <div id="createDatabaseModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Create New Database</h3>
                <button class="modal-close" onclick="maldb.hideCreateDatabaseModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="newDatabaseName">Database Name</label>
                    <input type="text" id="newDatabaseName" placeholder="e.g., my_database" class="form-input" autofocus>
                    <div class="form-hint">Use letters, numbers, and underscores only</div>
                </div>
                <div class="warning-text">
                    Note: "default" database is always available. New databases will be completely isolated.
                </div>
            </div>
            <div class="modal-footer">
                <button class="toolbar-btn" onclick="maldb.hideCreateDatabaseModal()">Cancel</button>
                <button class="toolbar-btn primary" onclick="maldb.createDatabase()">Create Database</button>
            </div>
        </div>
    </div>
    
    <!-- Modal for confirming database deletion -->
    <div id="deleteDatabaseModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Delete Database</h3>
                <button class="modal-close" onclick="maldb.hideDeleteDatabaseModal()">&times;</button>
            </div>
            <div class="modal-body">
                <p>Are you sure you want to delete database "<span id="deleteDbName"></span>"?</p>
                <p class="warning-text">âš ï¸ This action cannot be undone. All data in this database will be permanently deleted.</p>
                <p style="color: var(--text-secondary); font-size: 13px; margin-top: 8px;">
                    Note: The "default" database cannot be deleted.
                </p>
            </div>
            <div class="modal-footer">
                <button class="toolbar-btn" onclick="maldb.hideDeleteDatabaseModal()">Cancel</button>
                <button class="toolbar-btn danger" onclick="maldb.confirmDeleteDatabase()">Delete Database</button>
            </div>
        </div>
    </div>
</body>
</html>